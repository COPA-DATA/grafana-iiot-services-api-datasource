/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","lodash"],(function(e,r,t,a,n){return function(e){var r={};function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(a,n,function(r){return e[r]}.bind(null,n));return a},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="/",t(t.s=56)}([function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=a},function(e,r){e.exports=function(e){var r=typeof e;return null!=e&&("object"==r||"function"==r)}},function(e,r,t){var a=t(10),n=t(30),i=t(31),l=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":l&&l in Object(e)?n(e):i(e)}},function(e,r,t){var a=t(11),n="object"==typeof self&&self&&self.Object===Object&&self,i=a||n||Function("return this")();e.exports=i},function(e,r){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,r){e.exports=function(e){return e}},function(e,r,t){var a=t(5),n=t(4);e.exports=function(e){if(!n(e))return!1;var r=a(e);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}},function(e,r,t){var a=t(6).Symbol;e.exports=a},function(e,r,t){(function(r){var t="object"==typeof r&&r&&r.Object===Object&&r;e.exports=t}).call(this,t(29))},function(e,r){e.exports=function(e,r){return e===r||e!=e&&r!=r}},function(e,r,t){var a=t(9),n=t(14);e.exports=function(e){return null!=e&&n(e.length)&&!a(e)}},function(e,r){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,r){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var a=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==a||"symbol"!=a&&t.test(e))&&e>-1&&e%1==0&&e<r}},function(e,r){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,r,t){var a=t(53),n=t(54);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var i={insert:"head",singleton:!1},l=(a(n,i),n.locals?n.locals:{});e.exports=l},function(e,r,t){var a=t(20),n=t(12),i=t(37),l=t(38),o=Object.prototype,c=o.hasOwnProperty,s=a((function(e,r){e=Object(e);var t=-1,a=r.length,s=a>2?r[2]:void 0;for(s&&i(r[0],r[1],s)&&(a=1);++t<a;)for(var u=r[t],f=l(u),d=-1,v=f.length;++d<v;){var m=f[d],p=e[m];(void 0===p||n(p,o[m])&&!c.call(e,m))&&(e[m]=u[m])}return e}));e.exports=s},function(e,r){e.exports=n},function(e,r,t){var a=t(8),n=t(21),i=t(23);e.exports=function(e,r){return i(n(e,r,a),e+"")}},function(e,r,t){var a=t(22),n=Math.max;e.exports=function(e,r,t){return r=n(void 0===r?e.length-1:r,0),function(){for(var i=arguments,l=-1,o=n(i.length-r,0),c=Array(o);++l<o;)c[l]=i[r+l];l=-1;for(var s=Array(r+1);++l<r;)s[l]=i[l];return s[r]=t(c),a(e,this,s)}}},function(e,r){e.exports=function(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}},function(e,r,t){var a=t(24),n=t(36)(a);e.exports=n},function(e,r,t){var a=t(25),n=t(26),i=t(8),l=n?function(e,r){return n(e,"toString",{configurable:!0,enumerable:!1,value:a(r),writable:!0})}:i;e.exports=l},function(e,r){e.exports=function(e){return function(){return e}}},function(e,r,t){var a=t(27),n=function(){try{var e=a(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=n},function(e,r,t){var a=t(28),n=t(35);e.exports=function(e,r){var t=n(e,r);return a(t)?t:void 0}},function(e,r,t){var a=t(9),n=t(32),i=t(4),l=t(34),o=/^\[object .+?Constructor\]$/,c=Function.prototype,s=Object.prototype,u=c.toString,f=s.hasOwnProperty,d=RegExp("^"+u.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||n(e))&&(a(e)?d:o).test(l(e))}},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,r,t){var a=t(10),n=Object.prototype,i=n.hasOwnProperty,l=n.toString,o=a?a.toStringTag:void 0;e.exports=function(e){var r=i.call(e,o),t=e[o];try{e[o]=void 0;var a=!0}catch(e){}var n=l.call(e);return a&&(r?e[o]=t:delete e[o]),n}},function(e,r){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},function(e,r,t){var a,n=t(33),i=(a=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";e.exports=function(e){return!!i&&i in e}},function(e,r,t){var a=t(6)["__core-js_shared__"];e.exports=a},function(e,r){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,r){e.exports=function(e,r){return null==e?void 0:e[r]}},function(e,r){var t=Date.now;e.exports=function(e){var r=0,a=0;return function(){var n=t(),i=16-(n-a);if(a=n,i>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},function(e,r,t){var a=t(12),n=t(13),i=t(15),l=t(4);e.exports=function(e,r,t){if(!l(t))return!1;var o=typeof r;return!!("number"==o?n(t)&&i(r,t.length):"string"==o&&r in t)&&a(t[r],e)}},function(e,r,t){var a=t(39),n=t(50),i=t(13);e.exports=function(e){return i(e)?a(e,!0):n(e)}},function(e,r,t){var a=t(40),n=t(41),i=t(43),l=t(44),o=t(15),c=t(46),s=Object.prototype.hasOwnProperty;e.exports=function(e,r){var t=i(e),u=!t&&n(e),f=!t&&!u&&l(e),d=!t&&!u&&!f&&c(e),v=t||u||f||d,m=v?a(e.length,String):[],p=m.length;for(var h in e)!r&&!s.call(e,h)||v&&("length"==h||f&&("offset"==h||"parent"==h)||d&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||o(h,p))||m.push(h);return m}},function(e,r){e.exports=function(e,r){for(var t=-1,a=Array(e);++t<e;)a[t]=r(t);return a}},function(e,r,t){var a=t(42),n=t(7),i=Object.prototype,l=i.hasOwnProperty,o=i.propertyIsEnumerable,c=a(function(){return arguments}())?a:function(e){return n(e)&&l.call(e,"callee")&&!o.call(e,"callee")};e.exports=c},function(e,r,t){var a=t(5),n=t(7);e.exports=function(e){return n(e)&&"[object Arguments]"==a(e)}},function(e,r){var t=Array.isArray;e.exports=t},function(e,r,t){(function(e){var a=t(6),n=t(45),i=r&&!r.nodeType&&r,l=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=l&&l.exports===i?a.Buffer:void 0,c=(o?o.isBuffer:void 0)||n;e.exports=c}).call(this,t(16)(e))},function(e,r){e.exports=function(){return!1}},function(e,r,t){var a=t(47),n=t(48),i=t(49),l=i&&i.isTypedArray,o=l?n(l):a;e.exports=o},function(e,r,t){var a=t(5),n=t(14),i=t(7),l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Arguments]"]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l["[object Map]"]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&n(e.length)&&!!l[a(e)]}},function(e,r){e.exports=function(e){return function(r){return e(r)}}},function(e,r,t){(function(e){var a=t(11),n=r&&!r.nodeType&&r,i=n&&"object"==typeof e&&e&&!e.nodeType&&e,l=i&&i.exports===n&&a.process,o=function(){try{var e=i&&i.require&&i.require("util").types;return e||l&&l.binding&&l.binding("util")}catch(e){}}();e.exports=o}).call(this,t(16)(e))},function(e,r,t){var a=t(4),n=t(51),i=t(52),l=Object.prototype.hasOwnProperty;e.exports=function(e){if(!a(e))return i(e);var r=n(e),t=[];for(var o in e)("constructor"!=o||!r&&l.call(e,o))&&t.push(o);return t}},function(e,r){var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},function(e,r){e.exports=function(e){var r=[];if(null!=e)for(var t in Object(e))r.push(t);return r}},function(e,r,t){"use strict";var a,n=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},i=function(){var e={};return function(r){if(void 0===e[r]){var t=document.querySelector(r);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[r]=t}return e[r]}}(),l=[];function o(e){for(var r=-1,t=0;t<l.length;t++)if(l[t].identifier===e){r=t;break}return r}function c(e,r){for(var t={},a=[],n=0;n<e.length;n++){var i=e[n],c=r.base?i[0]+r.base:i[0],s=t[c]||0,u="".concat(c," ").concat(s);t[c]=s+1;var f=o(u),d={css:i[1],media:i[2],sourceMap:i[3]};-1!==f?(l[f].references++,l[f].updater(d)):l.push({identifier:u,updater:h(d,r),references:1}),a.push(u)}return a}function s(e){var r=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var n=t.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(e){r.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(r);else{var l=i(e.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(r)}return r}var u,f=(u=[],function(e,r){return u[e]=r,u.filter(Boolean).join("\n")});function d(e,r,t,a){var n=t?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=f(r,n);else{var i=document.createTextNode(n),l=e.childNodes;l[r]&&e.removeChild(l[r]),l.length?e.insertBefore(i,l[r]):e.appendChild(i)}}function v(e,r,t){var a=t.css,n=t.media,i=t.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),i&&btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,p=0;function h(e,r){var t,a,n;if(r.singleton){var i=p++;t=m||(m=s(r)),a=d.bind(null,t,i,!1),n=d.bind(null,t,i,!0)}else t=s(r),a=v.bind(null,t,r),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return a(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;a(e=r)}else n()}}e.exports=function(e,r){(r=r||{}).singleton||"boolean"==typeof r.singleton||(r.singleton=n());var t=c(e=e||[],r);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<t.length;a++){var n=o(t[a]);l[n].references--}for(var i=c(e,r),s=0;s<t.length;s++){var u=o(t[s]);0===l[u].references&&(l[u].updater(),l.splice(u,1))}t=i}}}},function(e,r,t){(r=t(55)(!0)).push([e.i,".min-width-10{min-width:10rem}.min-width-12{min-width:12rem}.min-width-20{min-width:20rem}.margin-1{padding-left:.5rem;padding-right:.5rem}.center{margin-top:.5rem;margin-left:.5rem;margin-right:.5rem}","",{version:3,sources:["app.css"],names:[],mappings:"AAAA,cAAc,eAAe,CAAC,cAAc,eAAe,CAAC,cAAc,eAAe,CAAC,UAAU,kBAAkB,CAAC,mBAAmB,CAAC,QAAQ,gBAAgB,CAAC,iBAAiB,CAAC,kBAAkB",file:"app.css",sourcesContent:[".min-width-10{min-width:10rem}.min-width-12{min-width:12rem}.min-width-20{min-width:20rem}.margin-1{padding-left:.5rem;padding-right:.5rem}.center{margin-top:.5rem;margin-left:.5rem;margin-right:.5rem}"]}]),e.exports=r},function(e,r,t){"use strict";e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var t=function(e,r){var t=e[1]||"",a=e[3];if(!a)return t;if(r&&"function"==typeof btoa){var n=(l=a,o=btoa(unescape(encodeURIComponent(JSON.stringify(l)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(c," */")),i=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[t].concat(i).concat([n]).join("\n")}var l,o,c;return[t].join("\n")}(r,e);return r[2]?"@media ".concat(r[2]," {").concat(t,"}"):t})).join("")},r.i=function(e,t,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(n[l]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);a&&n[c[0]]||(t&&(c[2]?c[2]="".concat(t," and ").concat(c[2]):c[2]=t),r.push(c))}},r}},function(e,r,t){"use strict";t.r(r);var a=t(2),n=function(e,r){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function i(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var l,o,c,s=function(){return(s=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};function u(e,r,t,a){return new(t||(t=Promise))((function(n,i){function l(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(l,o)}c((a=a.apply(e,r||[])).next())}))}function f(e,r){var t,a,n,i,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,a=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(n=l.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){l.label=i[1];break}if(6===i[0]&&l.label<n[1]){l.label=n[1],n=i;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(i);break}n[2]&&l.ops.pop(),l.trys.pop();continue}i=r.call(e,l)}catch(e){i=[6,e],a=0}finally{t=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}function d(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],a=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}!function(e){e.ArchiveData="archiveData",e.VariableValues="variableValues",e.Alarms="alarms",e.Events="events"}(l||(l={})),function(e){e.ServiceEngine="ServiceEngine",e.DataStorage="DataStorage"}(o||(o={})),function(e){e.Datasources="Datasources",e.ArchivesForDatasource="ArchivesForDataSource",e.VariablesForArchive="VariablesForArchive",e.VariablesForDatasource="VariablesForDatasource"}(c||(c={}));var v={queryType:l.ArchiveData,alarmsEventsFilter:{variables:["*"],onlyActive:!1,onlyCleared:!1,onlyUnacknowledged:!1},archiveFilter:{origin:o.DataStorage,variables:[]},variableFilter:{variables:[]}},m={queryType:c.Datasources},p=t(3),h=function(e){function r(r){var t=e.call(this,r)||this;return t.url=r.url,t.showOfflineDatasources=r.jsonData.showOfflineDatasources||!1,t}return i(r,e),r.prototype.query=function(e){return u(this,void 0,Promise,(function(){var r,t,a,n,i,o,c,s,u,v=this;return f(this,(function(f){if((r=e.targets.filter((function(e){return 1!=e.hide}))).forEach((function(r){r=v.replaceTemplateVariables(r,e.scopedVars)})),t=e.range.from,a=e.range.to,0===r.length)return[2,Promise.resolve({data:[]})];n=[];try{for(i=d(r),o=i.next();!o.done;o=i.next())if((c=o.value).datasourceId&&(c.queryType!=l.ArchiveData||c.archiveFilter.archiveId&&0!=c.archiveFilter.variables.length))switch(c.queryType){case l.ArchiveData:n.push(this.queryArchiveValues(c,t,a));break;case l.Alarms:case l.Events:n.push(this.queryAlarmsEvents(c,t,a));break;case l.VariableValues:n.push(this.queryOnlineValues(c))}}catch(e){s={error:e}}finally{try{o&&!o.done&&(u=i.return)&&u.call(i)}finally{if(s)throw s.error}}return[2,Promise.all(n).then((function(e){return Promise.resolve({data:e.flat()})}))]}))}))},r.prototype.replaceTemplateVariables=function(e,r){e.datasourceId=Object(p.getTemplateSrv)().replace(e.datasourceId,r),e.archiveFilter.archiveId=Object(p.getTemplateSrv)().replace(e.archiveFilter.archiveId,r);var t=function(e){var t,a,n=[];try{for(var i=d(e),l=i.next();!l.done;l=i.next()){var o=l.value,c=Object(p.getTemplateSrv)().replace(o,r);'["'==c.substr(0,2)?n=n.concat(JSON.parse(c)):n.push(c.replace(/['"]+/g,""))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return n};return e.archiveFilter.variables=t(e.archiveFilter.variables),e.alarmsEventsFilter.variables=t(e.alarmsEventsFilter.variables),e.variableFilter.variables=t(e.variableFilter.variables),e},r.prototype.metricFindQuery=function(e,r){return u(this,void 0,Promise,(function(){var r;return f(this,(function(t){r=new RegExp("");try{r=new RegExp(e.regexString,"i")}catch(e){}switch(e.queryType){case c.Datasources:return[2,this.findDataSources().then((function(e){var t,a,n=[];try{for(var i=d(e),l=i.next();!l.done;l=i.next()){var o=l.value;null!=o.label.match(r)&&n.push({text:o.label,value:o.value})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return Promise.resolve(n)}))];case c.ArchivesForDatasource:return[2,this.findArchives(e.datasourceId).then((function(e){var t,a,n=[];try{for(var i=d(e),l=i.next();!l.done;l=i.next()){var o=l.value;null!=o.label.match(r)&&n.push({text:o.label,value:o.value})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return Promise.resolve(n)}))];case c.VariablesForArchive:return[2,this.findVariablesForArchive(e.datasourceId,e.archiveId).then((function(e){var t,a,n=[];try{for(var i=d(e),l=i.next();!l.done;l=i.next()){var o=l.value;null!=o.label.match(r)&&n.push({text:o.label,value:o.value})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return Promise.resolve(n)}))];case c.VariablesForDatasource:return[2,this.findVariables(e.datasourceId).then((function(e){var t,a,n=[];try{for(var i=d(e),l=i.next();!l.done;l=i.next()){var o=l.value;null!=o.label.match(r)&&n.push({text:o.label,value:o.value})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return Promise.resolve(n)}))]}return[2]}))}))},r.prototype.testDatasource=function(){return u(this,void 0,void 0,(function(){return f(this,(function(e){return[2,Object(p.getBackendSrv)().datasourceRequest({url:this.url+"/",method:"GET"}).then((function(e){return Promise.resolve({status:"success",message:"Connection test successful"})}),(function(e){return Promise.resolve({status:"error",message:"Error: "+e.status+" "+e.statusText})}))]}))}))},r.prototype.queryArchiveValues=function(e,r,t){var n=this.url+"/api/v2/datasources/"+e.datasourceId+"/archives/"+e.archiveFilter.archiveId+"/query",i={variableFilter:{variableNames:e.archiveFilter.variables},timeFilter:{from:r.toISOString(),to:t.toISOString(),type:"Absolute"},origin:e.archiveFilter.origin};return Object(p.getBackendSrv)().datasourceRequest({url:n,data:i,method:"POST"}).then((function(r){var t,n,i,l,o;if(!("data"in r)||!("variables"in r.data))throw{data:{message:"Query Error: Retrieved data has invalid format"}};var c=r.data.variables,s=[];try{for(var u=d(c),f=u.next();!f.done;f=u.next()){var v=f.value,m=new a.MutableDataFrame({refId:e.refId,fields:[{name:v.archiveVariable.variableName,type:a.FieldType.number},{name:"time",type:a.FieldType.time}]});try{for(var p=(i=void 0,d(v.values)),h=p.next();!h.done;h=p.next()){var y=h.value,b=Date.parse(y.timestamp),g=y.value;isNaN(g)||(g=Number(g)),m.add(((o={time:b})[v.archiveVariable.variableName]=g,o))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(l=p.return)&&l.call(p)}finally{if(i)throw i.error}}if(!("archiveVariable"in v)||!("variableName"in v.archiveVariable))throw{data:{message:"Query Error: Retrieved data has invalid format"}};s.push(m)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return Promise.resolve(s)}),this.handleHttpErrors).catch(this.handleQueryException)},r.prototype.queryOnlineValues=function(e){var r=this.url+"/api/v1/datasources/"+e.datasourceId+"/variables/query",t={nameFilter:{variableNames:e.variableFilter.variables},fields:["name","value","lastUpdateTime"]};return Object(p.getBackendSrv)().datasourceRequest({url:r,data:t,method:"POST"}).then((function(r){var t,n,i;if(!("data"in r)||!("variables"in r.data))throw{data:{message:"Query Error: Retrieved data has invalid format"}};var l=r.data.variables,o=[];try{for(var c=d(l),s=c.next();!s.done;s=c.next()){var u=s.value,f=new a.MutableDataFrame({refId:e.refId,fields:[{name:u.name,type:a.FieldType.number},{name:"time",type:a.FieldType.time}]});f.add(((i={time:u.lastUpdateTime})[u.name]=u.value,i)),o.push(f)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve(o)}),this.handleHttpErrors).catch(this.handleQueryException)},r.prototype.queryAlarmsEvents=function(e,r,t){var n=this.url+"/api/v1/datasources/"+e.datasourceId;e.queryType==l.Alarms?n+="/alarms/query":e.queryType==l.Events&&(n+="/events/query");var i={timeFilter:{from:r.toISOString(),to:t.toISOString(),type:"Absolute"},variableFilter:{variableNames:e.alarmsEventsFilter.variables}};if(void 0!==e.alarmsEventsFilter&&e.queryType==l.Alarms){var o=[];e.alarmsEventsFilter.onlyActive&&o.push("OnlyActive"),e.alarmsEventsFilter.onlyCleared&&o.push("OnlyCleared"),e.alarmsEventsFilter.onlyUnacknowledged&&o.push("OnlyUnacknowledged"),o.length>0&&(i.filterFlags=o)}return Object(p.getBackendSrv)().datasourceRequest({url:n,data:i,method:"POST"}).then((function(r){var t,n,i,o;if(!("data"in r)||e.queryType==l.Alarms&&!("alarms"in r.data)||e.queryType==l.Events&&!("events"in r.data))throw{data:{message:"Query Error: Retrieved data has invalid format"}};var c=[];"alarms"in r.data?c=r.data.alarms:"events"in r.data&&(c=r.data.events);var s=void 0;switch(e.queryType){default:case l.Alarms:var u=new a.MutableDataFrame({refId:e.refId,fields:[{name:"id",type:a.FieldType.string,config:{displayName:"Id"}},{name:"variableName",type:a.FieldType.string,config:{displayName:"Variable Name"}},{name:"value",type:a.FieldType.other,config:{displayName:"Value"}},{name:"text",type:a.FieldType.string,config:{displayName:"Text"}},{name:"comment",type:a.FieldType.string,config:{displayName:"Comment"}},{name:"receivedTime",type:a.FieldType.time,config:{displayName:"Time Received"}},{name:"clearedTime",type:a.FieldType.time,config:{displayName:"Time Cleared"}},{name:"acknowledgedTime",type:a.FieldType.time,config:{displayName:"Time Acknowledged"}},{name:"computer",type:a.FieldType.string,config:{displayName:"Computer"}},{name:"acknowledgedBy",type:a.FieldType.string,config:{displayName:"Acknowledged by"}}]});try{for(var f=d(c),v=f.next();!v.done;v=f.next()){var m=v.value;u.add({id:m.id||null,variableName:m.variableName||null,value:m.value||null,text:m.text||null,comment:m.comment||null,receivedTime:Date.parse(m.receivedTime)||null,clearedTime:Date.parse(m.clearedTime)||null,acknowledgedTime:Date.parse(m.acknowledgedTime)||null,computer:m.computer||null,acknowledgedBy:m.username||m.userFullName||null})}}catch(e){t={error:e}}finally{try{v&&!v.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}s=u;break;case l.Events:var p=new a.MutableDataFrame({refId:e.refId,fields:[{name:"id",type:a.FieldType.string,config:{displayName:"Id"}},{name:"variableName",type:a.FieldType.string,config:{displayName:"Variable Name"}},{name:"value",type:a.FieldType.other,config:{displayName:"Value"}},{name:"text",type:a.FieldType.string,config:{displayName:"Text"}},{name:"comment",type:a.FieldType.string,config:{displayName:"Comment"}},{name:"receivedTime",type:a.FieldType.time,config:{displayName:"Time Received"}},{name:"computer",type:a.FieldType.string,config:{displayName:"Computer"}},{name:"user",type:a.FieldType.string,config:{displayName:"User"}}]});try{for(var h=d(c),y=h.next();!y.done;y=h.next()){m=y.value;p.add({id:m.id||null,variableName:m.variableName||null,value:m.value||null,text:m.text||null,comment:m.comment||null,receivedTime:Date.parse(m.receivedTime)||null,computer:m.computer||null,user:m.username||m.userFullName||null})}}catch(e){i={error:e}}finally{try{y&&!y.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}s=p}return Promise.resolve([s])}),this.handleHttpErrors).catch(this.handleQueryException)},r.prototype.findDataSources=function(){var e=this;return Object(p.getBackendSrv)().datasourceRequest({url:this.url+"/api/v2/datasources",method:"GET"}).then((function(r){var t,a,n=[];if(!("dataSourcesOrigin"in r.data))throw{data:{message:"Query Error: Could not parse list of data sources"}};var i=r.data.dataSourcesOrigin;if(void 0===i||i instanceof Array==0)throw{data:{message:"Query Error: Could not parse list of data sources"}};try{for(var l=d(i),o=l.next();!o.done;o=l.next()){var c=o.value;if(!("dataSourceId"in c)||!("name"in c)||!("dataOrigin"in c))throw{data:{message:"Query Error: Unknown/Invalid format"}};if(0!=c.dataOrigin.filter((function(e){return"Available"==e.state})).length||e.showOfflineDatasources){var s={label:c.name,value:c.dataSourceId};n.push(s)}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(a=l.return)&&a.call(l)}finally{if(t)throw t.error}}return n.sort((function(e,r){return e.label>r.label?1:-1})),Promise.resolve(n)}),this.handleHttpErrors).catch(this.handleQueryException)},r.prototype.findArchives=function(e,r){return void 0===r&&(r=o.DataStorage),null==e||""==e?Promise.resolve([]):(e=Object(p.getTemplateSrv)().replace(e),Object(p.getBackendSrv)().datasourceRequest({url:this.url+"/api/v2/datasources/"+e+"/archives",method:"GET"}).then((function(e){var t=[];if(!("archives"in e.data))throw{data:{message:"Query Error: Could not parse list of archives"}};var a=e.data.archives;if(void 0===a||a instanceof Array==0)throw{data:{message:"Query Error: Could not parse list of archives"}};return function e(a,n){var i,l;try{for(var o=d(a),c=o.next();!c.done;c=o.next()){var s=c.value;if(!("identification"in s)||!("name"in s))throw{data:{message:"Query Error: Unknown/Invalid format"}};var u={label:(n?"- aggregated - ":"")+s.name,value:s.identification};-1!=s.dataOrigin.indexOf(r)&&t.push(u),"aggregatedArchives"in s&&e(s.aggregatedArchives,!0)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(l=o.return)&&l.call(o)}finally{if(i)throw i.error}}}(a,!1),t.sort((function(e,r){return e.label.replace(/- aggregated - /,"")>r.label.replace(/- aggregated - /,"")?1:-1})),Promise.resolve(t)}),(function(e){return Promise.resolve([])})))},r.prototype.findVariablesForArchive=function(e,r){return null==e||""==e||null==r||""==r?Promise.resolve([]):(e=Object(p.getTemplateSrv)().replace(e),r=Object(p.getTemplateSrv)().replace(r),Object(p.getBackendSrv)().datasourceRequest({url:this.url+"/api/v2/datasources/"+e+"/archives/"+r,method:"GET"}).then((function(e){if(!("variables"in e.data))throw{data:{message:"Query Error: Could not parse list of variables"}};var r=e.data.variables;if(void 0===r||r instanceof Array==0)throw{data:{message:"Query Error: Could not parse list of variables"}};var t=r.map((function(e){return{label:e.variableName,value:e.variableName}}));return t.sort((function(e,r){return e.label>r.label?1:-1})),Promise.resolve(t)}),this.handleHttpErrors).catch(this.handleQueryException))},r.prototype.findVariables=function(e){if(null==e||""==e)return Promise.resolve([]);e=Object(p.getTemplateSrv)().replace(e);var r=this.url+"/api/v1/datasources/"+e+"/variables/query";return Object(p.getBackendSrv)().datasourceRequest({url:r,data:{fields:["name"],nameFilter:{variableNames:["*"]}},method:"POST"}).then((function(e){if(!("variables"in e.data))throw{data:{message:"Query Error: Could not parse list of variables"}};var r=e.data.variables.map((function(e){return{label:e.name,value:e.name}}));return r.sort((function(e,r){return e.label>r.label?1:-1})),Promise.resolve(r)}),this.handleHttpErrors).catch(this.handleQueryException)},r.prototype.handleHttpErrors=function(e){throw 401===e.status&&(e.message="Authorization Error: "+e.status+" Unauthorized"),400==e.status&&(void 0!==e.data&&void 0!==e.data.errorMessage&&void 0!==e.data.variableErrors?e.message="Bad Request: "+e.data.errorMessage+"; Details: "+JSON.stringify(e.data.variableErrors):e.message="Bad Request"),void 0!==e.data&&void 0!==e.data.errorMessage&&(e.message=e.data.errorMessage),new Error(e.message)},r.prototype.handleQueryException=function(e){return"data"in e&&void 0!==e.data?Promise.reject(e):Promise.reject({data:{message:"Query Error: Error during requesting data from API. "+e.message}})},r}(a.DataSourceApi),y=t(0),b=t.n(y),g=t(1),w=g.LegacyForms.Switch,E=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.onOptionsChange=function(e){var t=r.props,a=t.onOptionsChange,n=t.options,i=s(s({},n.jsonData),{showOfflineDatasources:e.target.checked});a(s(s({},n),{jsonData:i}))},r}return i(r,e),r.prototype.render=function(){var e,r=this.props,t=r.options,n=r.onOptionsChange;return b.a.createElement("div",{className:"gf-form-group"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.DataSourceHttpSettings,{defaultUrl:"http://localhost:9400",dataSourceConfig:t,showAccessOptions:!0,onChange:n})),b.a.createElement("div",{className:"gf-form"},b.a.createElement("div",{className:"gf-form-group"},b.a.createElement("h3",{className:"page-heading"},"Misc"),b.a.createElement("div",{className:"gf-form-group"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(w,{checked:null!==(e=t.jsonData.showOfflineDatasources)&&void 0!==e&&e,label:"Show offline Datasources",labelClass:"width-14",onChange:Object(a.onUpdateDatasourceJsonDataOptionChecked)(this.props,"showOfflineDatasources"),tooltip:"Check this option to include temporary offline data sources in the query editor"}))))))},r}(y.PureComponent),S=t(18),x=t.n(S),A=(t(17),function(e){function r(r){var t=e.call(this,r)||this;t.getTemplateVariables=function(e){var r,t,a=Object(p.getTemplateSrv)().getVariables(),n=JSON.stringify(a),i=JSON.parse(n),l=[];try{for(var o=d(i),c=o.next();!c.done;c=o.next()){var s=c.value;"query"==s.type&&s.query.queryType==e&&l.push(s)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(t=o.return)&&t.call(o)}finally{if(r)throw r.error}}return l},t.componentDidMount=function(){t.props.datasource.findDataSources().then((function(e){var r,a,n=t.getTemplateVariables(c.Datasources);try{for(var i=d(n),l=i.next();!l.done;l=i.next()){var o=l.value;e.unshift({label:"$"+o.name,value:"$"+o.name})}}catch(e){r={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}t.setState({datasourceSelectables:e})}))},t.loadArchives=function(){var e=t.props,r=e.query,a=e.datasource;return new Promise((function(e){a.findArchives(r.datasourceId,r.archiveFilter.origin).then((function(r){var a,n,i=t.getTemplateVariables(c.ArchivesForDatasource);try{for(var l=d(i),o=l.next();!o.done;o=l.next()){var s=o.value;r.unshift({label:"$"+s.name,value:"$"+s.name})}}catch(e){a={error:e}}finally{try{o&&!o.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}t.setState({archiveSelectables:r}),e(r)}))}))},t.loadArchiveVariables=function(){var e=t.props,r=e.query,a=e.datasource;return new Promise((function(e){a.findVariablesForArchive(r.datasourceId,r.archiveFilter.archiveId).then((function(r){var a,n,i=t.getTemplateVariables(c.VariablesForArchive);try{for(var l=d(i),o=l.next();!o.done;o=l.next()){var s=o.value;r.unshift({label:"$"+s.name,value:"${"+s.name+":json}"})}}catch(e){a={error:e}}finally{try{o&&!o.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}t.setState({archiveVariableSelectables:r}),e(r)}))}))},t.loadVariables=function(){var e=t.props,r=e.query,a=e.datasource;return new Promise((function(e){a.findVariables(r.datasourceId).then((function(r){var a,n,i=t.getTemplateVariables(c.VariablesForDatasource);try{for(var l=d(i),o=l.next();!o.done;o=l.next()){var s=o.value;r.unshift({label:"$"+s.name,value:"${"+s.name+":json}"})}}catch(e){a={error:e}}finally{try{o&&!o.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}r.unshift({label:"*",value:"*"}),t.setState({variableSelectables:r}),e(r)}))}))},t.onSwitchChanged=function(e){var r=t.props,a=r.query;(0,r.onChange)(s(s({},a),{alarmsEventsFilter:s(s({},a.alarmsEventsFilter),{onlyActive:!a.alarmsEventsFilter.onlyActive})}))};var a={label:"Archive Data",value:l.ArchiveData},n={label:"Online Values",value:l.VariableValues},i={label:"Alarms",value:l.Alarms},u={label:"Events",value:l.Events},f=[{label:"Data Storage",value:o.DataStorage},{label:"Serivce Engine",value:o.ServiceEngine}];return t.state={datasourceSelectables:[],queryTypeSelectables:[a,n,i,u],archiveSelectables:[],archiveVariableSelectables:[],variableSelectables:[],dataOriginSelectables:f},t}return i(r,e),r.prototype.render=function(){var e,r=x()(this.props.query,v),t=this.props,a=t.onChange,n=t.onRunQuery,i=r.datasourceId,o=r.queryType,c=r.archiveFilter,u=r.alarmsEventsFilter,f=r.variableFilter,d=b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Origin"),b.a.createElement(g.Select,{className:"min-width-15",onChange:function(e){a(s(s({},r),{archiveFilter:s(s({},r.archiveFilter),{origin:e.value})}))},options:this.state.dataOriginSelectables,value:this.state.dataOriginSelectables.find((function(e){return e.value==c.origin}))})),m=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Archive"),b.a.createElement(g.AsyncSelect,{className:"min-width-15",key:JSON.stringify([r.datasourceId,r.archiveFilter.origin]),placeholder:"Select an archive...",onChange:function(e){a(s(s({},r),{archiveFilter:s(s({},r.archiveFilter),{archiveId:e.value})}))},loadOptions:this.loadArchives,defaultOptions:!0,value:this.state.archiveSelectables.find((function(e){return e.value==c.archiveId})),invalid:!this.state.archiveSelectables.find((function(e){return e.value==c.archiveId}))})),b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Variable"),b.a.createElement(g.AsyncMultiSelect,{className:"min-width-15",key:JSON.stringify([r.datasourceId,r.archiveFilter.origin,r.archiveFilter.archiveId]),placeholder:"Select a variable...",onChange:function(e){a(s(s({},r),{archiveFilter:s(s({},r.archiveFilter),{variables:e.map((function(e){return e.value}))})})),n()},loadOptions:this.loadArchiveVariables,defaultOptions:!0,value:this.state.archiveVariableSelectables.filter((function(e){return c.variables.includes(e.value)})),invalid:0==this.state.archiveVariableSelectables.filter((function(e){return c.variables.includes(e.value)})).length}))),p=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Variable Filter"),b.a.createElement(g.AsyncMultiSelect,{className:"min-width-10",key:r.queryType,onChange:function(e){a(s(s({},r),{alarmsEventsFilter:s(s({},r.alarmsEventsFilter),{variables:e.map((function(e){return e.value}))})})),n()},loadOptions:this.loadVariables,defaultOptions:!0,value:this.state.variableSelectables.filter((function(e){return u.variables.includes(e.value)})),invalid:0==this.state.variableSelectables.filter((function(e){return u.variables.includes(e.value)})).length})),b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword margin-1"},"Only Active"),b.a.createElement(g.Field,null,b.a.createElement("div",{className:"center"},b.a.createElement(g.Switch,{onChange:function(e){a(s(s({},r),{alarmsEventsFilter:s(s({},r.alarmsEventsFilter),{onlyActive:!r.alarmsEventsFilter.onlyActive})})),n()},value:u.onlyActive})))),b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword margin-1"},"Only Cleared"),b.a.createElement(g.Field,null,b.a.createElement("div",{className:"center"},b.a.createElement(g.Switch,{onChange:function(e){a(s(s({},r),{alarmsEventsFilter:s(s({},r.alarmsEventsFilter),{onlyCleared:!r.alarmsEventsFilter.onlyCleared})})),n()},value:u.onlyCleared})))),b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword margin-1"},"Only Unacknowledged"),b.a.createElement(g.Field,null,b.a.createElement("div",{className:"center"},b.a.createElement(g.Switch,{onChange:function(e){a(s(s({},r),{alarmsEventsFilter:s(s({},r.alarmsEventsFilter),{onlyUnacknowledged:!r.alarmsEventsFilter.onlyUnacknowledged})})),n()},value:u.onlyUnacknowledged}))))),h=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Variable Filter"),b.a.createElement(g.AsyncMultiSelect,{className:"min-width-15",key:r.queryType,onChange:function(e){a(s(s({},r),{alarmsEventsFilter:s(s({},r.alarmsEventsFilter),{variables:e.map((function(e){return e.value}))})})),n()},loadOptions:this.loadVariables,defaultOptions:!0,value:this.state.variableSelectables.filter((function(e){return u.variables.includes(e.value)})),invalid:0==this.state.variableSelectables.filter((function(e){return u.variables.includes(e.value)})).length}))),y=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Variable Filter"),b.a.createElement(g.AsyncMultiSelect,{className:"min-width-15",key:r.queryType,onChange:function(e){a(s(s({},r),{variableFilter:s(s({},r.variableFilter),{variables:e.map((function(e){return e.value}))})})),n()},loadOptions:this.loadVariables,defaultOptions:!0,value:this.state.variableSelectables.filter((function(e){return f.variables.includes(e.value)})),invalid:0==this.state.variableSelectables.filter((function(e){return f.variables.includes(e.value)})).length})));switch(r.queryType){case l.ArchiveData:e=m;break;case l.Alarms:e=p;break;case l.Events:e=h;break;case l.VariableValues:e=y}return b.a.createElement("div",null,b.a.createElement("div",{className:"gf-form-group"},b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Datasource"),b.a.createElement(g.Select,{className:"min-width-20",placeholder:"Select a datasource...",onChange:function(e){return a(s(s({},r),{datasourceId:e.value}))},options:this.state.datasourceSelectables,value:this.state.datasourceSelectables.find((function(e){return e.value==r.datasourceId})),invalid:!i}))),b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-7 margin-1"},"Query Type"),b.a.createElement(g.Select,{className:"min-width-10",onChange:function(e){a(s(s({},r),{queryType:e.value})),n()},options:this.state.queryTypeSelectables,value:this.state.queryTypeSelectables.find((function(e){return e.value==o}))})),r.queryType==l.ArchiveData&&d),e))},r}(y.Component)),F=t(19),O=g.LegacyForms.Input,T=function(e){function r(r){var t=e.call(this,r)||this;t.createDefinitionText=function(e){var r,a,n,i=null===(r=t.state.datasourceSelectables.find((function(r){return r.value==e.datasourceId})))||void 0===r?void 0:r.label,l=null===(a=t.state.archiveSelectables.find((function(r){return r.value==e.archiveId})))||void 0===a?void 0:a.label;switch(e.queryType){case c.Datasources:n="Service Grid Datasources";break;case c.ArchivesForDatasource:n="Archives for the Service Grid Datasource "+i;break;case c.VariablesForDatasource:n="Variables for the Service Grid Datasource "+i;break;case c.VariablesForArchive:n="Variables for archive "+l+" of the Service Grid Datasource "+i}return n},t.loadDatasources=function(){var e=t.props.datasource;return new Promise((function(r){e.findDataSources().then((function(e){t.setState({datasourceSelectables:e}),r(e)}))}))},t.loadArchives=function(){var e=t.props,r=e.query,a=e.datasource;return new Promise((function(e){a.findArchives(r.datasourceId).then((function(r){t.setState({archiveSelectables:r}),e(r)}))}))},t.isValidRegex=function(e){try{new RegExp(e)}catch(e){return!1}return!0};var a=[{label:"Datasources",value:c.Datasources},{label:"Archives for datasource",value:c.ArchivesForDatasource},{label:"Variables for datasource",value:c.VariablesForDatasource},{label:"Variables for archive",value:c.VariablesForArchive}];return t.state={datasourceSelectables:[],queryTypeSelectables:a,archiveSelectables:[],archiveVariableSelectables:[]},t}return i(r,e),r.prototype.render=function(){var e=this,r=Object(F.defaults)(this.props.query,m),t=this.props.onChange;this.props.onChange;var a=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-10 margin-1"},"Datasource"),b.a.createElement(g.AsyncSelect,{className:"min-width-15",key:r.queryType,placeholder:"Select a datasource...",onChange:function(a){t(s(s({},r),{datasourceId:a.value}),e.createDefinitionText(s(s({},r),{datasourceId:a.value})))},loadOptions:this.loadDatasources,defaultOptions:!0,value:this.state.datasourceSelectables.find((function(e){return e.value==r.datasourceId})),invalid:!this.state.datasourceSelectables.find((function(e){return e.value==r.datasourceId}))}))),n=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-10 margin-1"},"Archive"),b.a.createElement(g.AsyncSelect,{className:"min-width-15",key:r.datasourceId,placeholder:"Select an archive...",onChange:function(a){t(s(s({},r),{archiveId:a.value}),e.createDefinitionText(s(s({},r),{archiveId:a.value})))},loadOptions:this.loadArchives,defaultOptions:!0,value:this.state.archiveSelectables.find((function(e){return e.value==r.archiveId})),invalid:!this.state.archiveSelectables.find((function(e){return e.value==r.archiveId}))}))),i=b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-10 margin-1"},"Filter values"),b.a.createElement(g.Field,{className:"min-width-15",invalid:!this.isValidRegex(r.regexString),error:this.isValidRegex(r.regexString)?"":"Invalid regex pattern"},b.a.createElement(O,{placeholder:"Apply regex filter to values ...",value:r.regexString,onChange:function(a){t(s(s({},r),{regexString:a.target.value}),e.createDefinitionText(s(s({},r),{regexString:a.target.value})))}}))));return b.a.createElement("div",null,b.a.createElement("div",{className:"gf-form-group"},b.a.createElement("div",{className:"gf-form-inline"},b.a.createElement("div",{className:"gf-form"},b.a.createElement(g.Label,{className:"gf-form-label query-keyword width-10 margin-1"},"Query Type"),b.a.createElement(g.Select,{className:"min-width-10",onChange:function(a){return t(s(s({},r),{queryType:a.value}),e.createDefinitionText(s(s({},r),{queryType:a.value})))},options:this.state.queryTypeSelectables,value:this.state.queryTypeSelectables.find((function(e){return e.value==r.queryType}))}))),r.queryType!=c.Datasources&&a,r.queryType==c.VariablesForArchive&&n,i))},r}(y.Component);t.d(r,"plugin",(function(){return N}));var N=new a.DataSourcePlugin(h).setConfigEditor(E).setQueryEditor(A).setVariableQueryEditor(T)}])}));
//# sourceMappingURL=module.js.map